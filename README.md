# text_JSQL

简要的说明：
1，多电脑联机的时候，应该在服务器运行dialog_box_server.py,然后再在客户端电脑上运行dialog_box_client.py，分别设置角色为红蓝方，设一下IP，然后启动起来。
1.5，要是用QtC++的前端而非自己的前端，那就应该是在客户端电脑上运行dialog_box_client2.py。
2，多电脑联机的时候，客户端和大模型交互，服务器和平台交互。天然就是异步的。
3，生成解说词是运行TTS_generator.py
4，tools里面含有半自动更新AI的代码。


# 下面是过程内容，不看也罢
============================================================================
这个是提前构思的用来尝试连接决胜千里平台和大模型，从而用来实现决策的东西


构思一下代码框架：

规则智能体应该是独立的一个文件夹，包含agent.py等物，把和平台通信的东西也放到这个里面去。

“提取态势形成文本”应该是一个独立的功能模块，放一个文件夹里面。

“和大模型交互”应该是一个独立的功能模块，放一个文件夹里面。这个库本身不包含大模型，只管用。

然后再来个主函数把它们串起来，想必就是比较好的。原生多线程吧，上来就设计成异步的，以便人机混合。
异步是多个层级的，一方面大模型生成命令和平台推演应该是异步的，比如隔一定步数来一次。另一方面，人类干涉和大模型生成命令也应该是异步的。

-----------------------
TODO：
1，人混打手操用的通信组件。得搭配新的dialog_box才能实现。这个的奔头在于人机打手操。或者到时候人机打人机肯定也是用这个。
1.5，大模型命令那个改成异步调用的机制，不然人机打人怎么打
1.6，后面考虑整个统一的runner，把各种机制集中一下。现在有点熵增了。
2，两边都大模型互相A，好像没有什么技术问题，还没想好怎么编。
3，地形的处理，可能得上多模态调用试一下了，还没想好怎么编。


==========================================================================、
20241003，新开一个分支用于2024年的劳动竞赛。理想状况下应该实现两台电脑联机然后打。

当前需要的开发工作：

1，实现快速加载智能体。实现这个之前不妨先实现一个手动加载智能体。一定要防止整乱了。
2，实现内网联机。现在电脑比人多了，有条件对此进行调试了。
3，提示词得大改，语言交互那部分也得重新弄。
4，如果有可能的话把多模态的那部分弄进来

==========================================================================

20241005 搞快点，先把加载智能体的那部分弄了，然后调一下窗口什么网络通信那些整了。

还有一茬，两个电脑通信这个整完了之后，得整一个双player的主函数。
确切地说，是要搞成：dialog box在本地的命令传给一边，远方来的命令传给另一边。所以需要给命令一个所属方的属性。

==========================================================================
20241008 进一步地，其实应该是server挂两个client，分别是红蓝方，至于说它在哪里，是远程还是本地，那都是可以聊的。

还不对，最理想的应该是把态势同步过去，然后两个客户端分别跟大模型交互。这样要改的就多一些了。

或者说，由于想要通信是在弄了大模型之后通信，而不是只原样传输人的命令，所以socket交互这层要放在command process这层，而不是dialogbox这层。

这么分一下之后，原则上这个架构甚至可以实现多人的联席指挥。不过要实现这个需要的就是大量的纯苦力开发工作了，先别慌。


================================================================
20241011：集中解决一下态势通信的问题，搞一个只需要两台电脑的debug版本。

1，现在问题是两边都异步的，得有一个办法让它能够知道那边改了。


================================================================

20241014：适可而止吧大模型算是已经集成进去了，但是提示词还比较拉，但是目前提示词这茬还不是最关键的，先得是要搞一下别的。平台那边靠不了别人，还是得靠自己，去琢磨一下。以及今年的规则AI本质上是没有说法的。

================================================================

二〇二四年十月十七日 20:13:19
下一步，准备往多模态的方向去琢磨，入手的点是怎么截图


================================================================
20241121，好，今早调一下prompt，成功的标志是本地、阻塞通信的基础版本能够用起来。

一个合理的安排是，晚上练完回来再考虑联调大模型的事情了。


===============================================================

20241122，现在算是prompt基本调明白了。接下来的几个事情：
1，把langchain相关的修一修，把百度啥的换一些能力强点儿的。

成功，换了ernibot 3.5就已经很阳间了，之前觉得百度的那个不行估计是因为用的白板ernibot实在是太过垃圾导致的。且看这个的开销如何。那基本不用继续折腾提示词了，就这个就挺好的，后面等联调的时候再说。
ERNIE-3.5-8K的价格量级：
输入：¥0.0008元/千tokens
输出：¥0.002元/千tokens

================================================================

20241123,现在需要解决的是怎么和Qt那里连起来的问题。socket应该得重新弄弄，一个类里面开两个socket，一个连这边，一个连那边。

先把Qt那边建一个git，管理起来，比较安全。

================================================================
20241125，加了一圈debug的东西，改了一圈接口逻辑，姑且是准备开始调试了。
理想的情况应该是：命令和态势都能顺利转发，而且能够联机运行起来。

================================================================

今天要开始多机的联调了，别说还有点小紧张

节奏别乱，server那里的bind应该是自己的内网IP或者本地的127.0.0.1那个，不是client的IP。
然后client那里应该是服务器的IP，这样才称得上健全。

TODO: 回头改一版对连接顺序能够容错的。不过这个优先级不高

================================================================

一样一样的来，先实现stage prompt单边和双边的推起来，然后再来两个换成手打的。
先把服务器端的也改成能够点断点的那种，这样就全都能点断点调试了，可能就不需要时间延迟了。